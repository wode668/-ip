<!DOCTYPE html>
<html lang="en">
<head>
<link rel="manifest" href="manifest.json">
<!-- iOS 额外配置 -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" href="icons/icon-512.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>导航界面</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }

        .header {
            text-align: center;
            padding: 0px;
            background-color: #d1d1d1;
            color: white;
        }

   /* 修改后的导航栏容器 */
.tab-container-wrapper {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 30px; /* 只显示下拉尾巴的高度 */
    overflow: hidden;
    transition: height 0.3s ease;
    z-index: 1000;
    background-color: #d1d1d1;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.tab-container-wrapper.expanded {
    height: auto; /* 展开时高度自动 */
    min-height: 200px; /* 确保有足够空间显示所有标签 */
}

/* 下拉尾巴样式 */
.pull-handle {
    width: 100%;
    height: 30px;
    text-align: center;
    cursor: pointer;
    position: absolute;
    bottom: 0;
    left: 0;
    background-color: rgba(0,0,0,0.1);
    display: flex;
    justify-content: center;
    align-items: center;
}

.pull-handle::after {
    content: "";
    font-size: 16px;
    color: #666;
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
    40% {transform: translateY(-5px);}
    60% {transform: translateY(-3px);}
}

.tab-container {
    display: flex;
    flex-direction: column; /* 竖排排列 */
    background-color: #d1d1d1;
    padding: 20px 0;
    flex-wrap: wrap;
    gap: 10px; /* 减少间距 */
    padding-top: 30px; /* 为下拉尾巴留出空间 */
}

 .tab {
    padding: 12px 20px; /* 调整尺寸 */
    margin: 0 10px; /* 添加左右边距 */
    color: white;
    border-radius: 25px; /* 稍微减少圆角 */
    cursor: pointer;
    transition: all 0.3s;
    font-weight: bold;
    text-shadow: 0 1px 3px rgba(0,0,0,0.3);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    position: relative;
    overflow: hidden;
    border: none;
    text-align: center;
    font-size: 14px; /* 减小字体大小 */
    display: flex;
    align-items: center;
    justify-content: center;
}

/* 响应式调整 - 横屏时恢复原布局 */
@media (orientation: landscape) {
    .tab-container {
        flex-direction: row;
        justify-content: center;
    }
    
    .tab {
        margin: 0 5px;
        padding: 10px 15px;
    }
}

    /* 调整标签顺序对应的颜色 */
    .tab[data-tab="other1"] {
        background: linear-gradient(135deg, #9C27B0, #6A1B9A); /* 紫色 */
    }
    .tab[data-tab="other2"] {
        background: linear-gradient(135deg, #F44336, #C62828); /* 红色 */
    }
    .tab[data-tab="lamination"] {
        background: linear-gradient(135deg, #2196F3, #0D47A1); /* 蓝色 */
    }
    .tab[data-tab="composite"] {
        background: linear-gradient(135deg, #4CAF50, #2E7D32); /* 绿色 */
    }
    .tab[data-tab="three-layer"] {
        background: linear-gradient(135deg, #FF9800, #E65100); /* 橙色 */
    }
    .tab[data-tab="other3"] {
        background: linear-gradient(135deg, #81D4FA, #4FC3F7); /* 淡蓝色 */
    }

    .tab:hover {
        transform: translateY(-3px);
        box-shadow: 0 7px 14px rgba(0,0,0,0.25);
    }

    .tab.active {
        filter: brightness(150%);
        box-shadow: 0 0 20px 8px rgba(255,100,0,0.7),
                    0 0 30px 15px rgba(255,200,0,0.5),
                    0 0 40px 20px rgba(255,255,0,0.3);
        transform: translateY(-3px) scale(1.08);
        z-index: 10;
    }

    @keyframes flame {
        0% { box-shadow: 0 0 15px 5px rgba(255,100,0,0.7); }
        50% { box-shadow: 0 0 25px 12px rgba(255,200,0,0.6); }
        100% { box-shadow: 0 0 20px 8px rgba(255,100,0,0.7); }
    }

    .tab.active {
        animation: flame 1.8s infinite alternate;
    }

        .tab:hover {
            background-color: #777;
        }

        .tab.active {
            background-color: #f0f0f0;
            color: #333;
            font-weight: bold;
        }

        .content-container {
            display: none;
            padding: 20px;
            background-color: #f0f0f0;
        }

        .content-container.active {
            display: block;
        }

        /* 复合无纺布样式 */
        .calculator-body {
    display: flex;
    flex-direction: column; /* 改为纵向排列 */
    padding: 20px;
    margin: 0;
}

.input-section {
    width: 100%; /* 占满宽度 */
    border-right: none; /* 移除右侧分隔线 */
}

.output-section {
    width: 100%;
    border-top: 2px solid gray; /* 顶部边框作为分隔 */
    margin-top: 20px;
}

        .input-row {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex: 1;
        }

        label {
            margin-bottom: 5px;
            font-weight: bold;
        }

        input {
            width: 100%;
            padding: 5px;
            box-sizing: border-box;
            color: red;
        }

        input[type="number"] {
            background-color: orange;
        }

        input[type="number"].has-value {
            background-color: #f0f0f0;
            color: red;
        }

        #f1 {
            background-color: lightblue;
        }

        button {
            padding: 10px;
            border: none;
            cursor: pointer;
            color: white;
            font-weight: bold;
            transition: transform 0.1s ease;
        }

        button.calculate {
            background-color: green;
            width: 300%;
            margin: 0 auto;
        }

        button.side {
            background-color: gray;
        }

        button:active {
            transform: scale(0.95);
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }

        .cost-result {
            color: green;
            font-weight: bold;
            font-size: 24px;
        }

        table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 10px;
    border: 1px solid black; /* 仅保留外边框 */
}

th, td {
    border-top: 1px solid black;
    border-bottom: 1px solid black;
    padding: 8px;
    text-align: left;
}

/* 移除第一列的左边框和最后一列的右边框 */
th:first-child,
td:first-child {
    border-left: none;
}

th:last-child,
td:last-child {
    border-right: none;
}

        /* 淋膜袋特定样式 */
       .lamination-body {
    display: flex;
    justify-content: space-between;
    position: relative;
}
.lamination-body::after {
    content: '';
    position: absolute;
    left: 32%;
    top: 0;
    bottom: 0;
    width: 1px;
    background-color: gray;
}

        /* 三层加厚特定样式 */
        .three-layer-body {
            display: flex;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

 .three-layer-body {
    display: flex;
    flex-direction: column; /* 改为纵向排列 */
}

.three-layer-input-section,
.three-layer-input-section-2 {
    width: 100%; /* 占满宽度 */
    border-right: none; /* 移除右边框 */
    border-bottom: 1px solid #ccc; /* 底部边框分隔 */
}

        .three-layer-output-section {
            width: 100%;
            padding: 20px;
        }

        .three-layer-input[type="number"] {
            color: red;
            width: 100%;
            padding: 5px;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
        }

        .three-layer-input[type="number"]:invalid {
            background-color: orange;
        }

        .three-layer-button {
            padding: 10px;
            margin: 5px;
            border: none;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s ease;
        }

        .three-layer-button.blue {
            background-color: blue;
            color: white;
        }

        .three-layer-button.gray {
            background-color: gray;
            color: white;
        }

        .three-layer-button.red {
            background-color: red;
            color: white;
        }

        .three-layer-button.green {
            background-color: green;
            color: white;
        }

        .three-layer-button:active {
            transform: scale(0.95);
        }

       /* === 修改后的三层加厚表格样式 === */
.three-layer-table {
    table-layout: fixed;      /* 关键1：固定布局算法 */
    width: 100%;             /* 确保占满父容器 */
    border-collapse: collapse;
    border: 1px solid black;
}

.three-layer-table td {
    border-bottom: 1px solid black;
    padding: 8px;
    text-align: left;
    white-space: nowrap;      /* 关键2：禁止自动换行 */
    overflow: hidden;         /* 隐藏溢出内容 */
    text-overflow: ellipsis;  /* 溢出显示省略号 */
}

/* 移动端适配 */
@media (max-width: 480px) {
    .three-layer-table td {
        white-space: normal;  /* 小屏允许换行 */
        word-break: break-all;/* 强制断词填充 */
    }
}

/* 移除第一列和最后一列的左右边框 */
.three-layer-table th:first-child,
.three-layer-table td:first-child {
    border-left: none;
}

.three-layer-table th:last-child,
.three-layer-table td:last-child {
    border-right: none;
}

        .three-layer-input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .three-layer-input-group label {
            font-weight: bold;
        }

        .three-layer-button-row {
            display: flex;
            gap: 10px;
        }

        .three-layer-button-row button {
            flex: 1;
        }

        .three-layer-input-row {
            display: flex;
            gap: 18px;
            align-items: center;
        }

        .three-layer-input-row .input-group {
            flex: 1;
        }

        .three-layer-input-group input[type="number"].u1 {
            background-color: lightblue;
        }

        .three-layer-input-group input[type="number"].u3 {
            background-color: lightblue;
        }

        .three-layer-z-input {
            width: 80px;
        }

        .three-layer-cost-output {
            font-size: 24px;
            color: green;
            font-weight: bold;
            margin-top: 20px;
        }

        .three-layer-z-input-container input[type="number"].default-value {
            background-color: #e0e0e0;
        }
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f0f0f0;
    padding-top: 20px; /* 为隐藏的导航栏留出空间 */
}
.input-group-row {
  display: flex;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 12px;
  width: 100%;
}

.input-col {
  flex: 1;
  min-width: 0; /* 关键：允许列收缩 */
}

.input-col label {
  display: block;
  text-align: center;
  font-size: 14px;
  color: #666;
  margin-bottom: 4px;
  white-space: nowrap; /* 禁止标签换行 */
  overflow: hidden;
  text-overflow: ellipsis;
}

.input-col input {
  width: 100%;
  padding: 8px;
  box-sizing: border-box;
  border: 1px solid #ccc;
  border-radius: 4px;
  text-align: center;
  font-size: 14px;
}

/* 移动端适配 */
@media (max-width: 480px) {
  .input-group-row {
    gap: 4px;
    margin-bottom: 8px;
  }
  
  .input-col label {
    font-size: 12px;
  }
  
  .input-col input {
    padding: 6px;
    font-size: 12px;
  }
  
  /* 超小屏处理 */
  @media (max-width: 360px) {
    .input-col label {
      white-space: normal; /* 允许标签换行 */
      line-height: 1.2;
    }
  }
}
    </style>
</head>
<body>
    <div class="header">
    </div>
<script>
  if ('serviceWorker' in navigator) {
    // 注册 Service Worker
    navigator.serviceWorker.register('/service-worker.js')
      .then(registration => {
        console.log('ServiceWorker 注册成功');
      })
      .catch(error => {
        console.log('ServiceWorker 注册失败:', error);
      });
  }
</script>

<div class="tab-container-wrapper" id="tabWrapper">
    <div class="tab-container" id="tabContainer">
        <div class="tab" data-tab="other1">无底无侧/有底无侧</div>
        <div class="tab" data-tab="other2">有底有侧</div>
        <div class="tab" data-tab="lamination">淋膜袋</div>
        <div class="tab" data-tab="composite">复合无纺布</div>
        <div class="tab" data-tab="three-layer">三层加厚</div>
        <div class="tab" data-tab="other3">双层</div>
    </div>
    <div class="pull-handle" id="pullHandle"></div>
</div>

    <!-- 复合无纺布计算器 -->
    <div id="composite" class="content-container active">
        <div class="calculator-body">
            <div class="input-section">
                <h2>复合无纺布</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label>长：</label>
                        <input type="number" id="q1" placeholder="请输入长">
                    </div>
                    <div class="input-group">
                        <label>高：</label>
                        <input type="number" id="q2" placeholder="请输入高">
                    </div>
                    <div class="input-group">
                        <label>侧：</label>
                        <input type="number" id="q3" placeholder="请输入侧">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>订购数量：</label>
                        <input type="number" id="p" placeholder="请输入订购数量">
                    </div>
                    <div class="input-group">
                        <label>预留数量：</label>
                        <input type="number" id="n" placeholder="请输入预留数量">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>布料售价：</label>
                        <input type="number" id="f1" value="9.2" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>数码印：</label>
                        <input type="number" id="f2" value="2.5" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>面出血各：</label>
                        <input type="number" id="r1" value="1.5" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>侧出血共：</label>
                        <input type="number" id="r3" value="3" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>口头出血：</label>
                        <input type="number" id="r2" value="5" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>幅宽：</label>
                        <input type="number" id="W" value="150" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>损耗：</label>
                        <input type="number" id="e" value="1.05" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>带刀扣点：</label>
                        <input type="number" id="q8" value="0" class="has-value">
                    </div>
                </div>

                <div class="button-group">
                    <button class="side" id="sideButton" onclick="toggleSide()">不带侧边</button>
                    <button class="calculate" onclick="calculateCost()">成本核算</button>
                </div>
            </div>

            <div class="output-section">
                <h2>计算结果</h2>
                <table>
                    <tr>
                        <td id="result1"></td>
                    </tr>
                    <tr>
                        <td id="result2"></td>
                    </tr>
                    <tr>
                        <td id="result3"></td>
                    </tr>
                    <tr>
                        <td id="result4"></td>
                    </tr>
                    <tr>
                        <td id="result5"></td>
                    </tr>
                </table>

                <div class="input-row">
                    <div class="input-group">
                        <label>布料：</label>
                        <input type="number" id="g1Input" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>工费：</label>
                        <input type="number" id="g9Input" value="3.2" class="has-value" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>印刷：</label>
                        <input type="number" id="g2Input" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>手提：</label>
                        <input type="number" id="g3Input" value="0.55" class="has-value" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>磁扣：</label>
                        <input type="number" id="g4Input" value="0.55" class="has-value" oninput="updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>飘带：</label>
                        <input type="number" id="g5Input" value="0" class="has-value" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>内袋：</label>
                        <input type="number" id="g6Input" value="0" class="has-value" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>切工：</label>
                        <input type="number" id="g7Input" value="0.3" class="has-value" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>打包：</label>
                        <input type="number" id="g8Input" oninput="updateCost()">
                    </div>
                    <div class="input-group">
                        <label>其他：</label>
                        <input type="number" id="g10Input" value="0" class="has-value" oninput="updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>成本：</label>
                        <span class="cost-result" id="costResult"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 淋膜袋计算器 -->
    <div id="lamination" class="content-container">
       <div class="calculator-body">
            <div class="input-section">
                <h2>淋膜款</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label>长：</label>
                        <input type="number" id="l_q1" placeholder="请输入长">
                    </div>
                    <div class="input-group">
                        <label>高：</label>
                        <input type="number" id="l_q2" placeholder="请输入高">
                    </div>
                    <div class="input-group">
                        <label>侧：</label>
                        <input type="number" id="l_q3" placeholder="请输入侧">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>订购数量：</label>
                        <input type="number" id="l_p" placeholder="请输入订购数量">
                    </div>
                    <div class="input-group">
                        <label>预留数量：</label>
                        <input type="number" id="l_n" placeholder="请输入预留数量">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>布料售价：</label>
                        <input type="number" id="l_f1" value="8.1" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>数码印：</label>
                        <input type="number" id="l_f2" value="3" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>面出血各：</label>
                        <input type="number" id="l_r1" value="0" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>侧出血共：</label>
                        <input type="number" id="l_r3" value="4.5" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>口头出血：</label>
                        <input type="number" id="l_r2" value="5" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>幅宽：</label>
                        <input type="number" id="l_W" value="150" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>损耗：</label>
                        <input type="number" id="l_e" value="1.05" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>带刀扣点：</label>
                        <input type="number" id="l_q8" value="0" class="has-value">
                    </div>
                </div>

                <div class="button-group">
                    <button class="side" id="l_sideButton" onclick="l_toggleSide()">不带侧边</button>
                    <button class="calculate" onclick="l_calculateCost()">成本核算</button>
                </div>
            </div>

            <div class="output-section">
                <h2>计算结果</h2>
                <table>
                    <tr>
                        <td id="l_result1"></td>
                    </tr>
                    <tr>
                        <td id="l_result2"></td>
                    </tr>
                    <tr>
                        <td id="l_result3"></td>
                    </tr>
                </table>

                <div class="input-row">
                    <div class="input-group">
                        <label>布料：</label>
                        <input type="number" id="l_g1Input" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>工费：</label>
                        <input type="number" id="l_g9Input" value="1.7" class="has-value" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>印刷：</label>
                        <input type="number" id="l_g2Input" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>手提：</label>
                        <input type="number" id="l_g3Input" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>磁扣：</label>
                        <input type="number" id="l_g4Input" value="0.55" class="has-value" oninput="l_updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>飘带：</label>
                        <input type="number" id="l_g5Input" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>内袋：</label>
                        <input type="number" id="l_g6Input" value="0" class="has-value" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>切工：</label>
                        <input type="number" id="l_g7Input" value="0.16" class="has-value" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>打包：</label>
                        <input type="number" id="l_g8Input" oninput="l_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>其他：</label>
                        <input type="number" id="l_g10Input" value="0" class="has-value" oninput="l_updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>成本：</label>
                        <span class="cost-result" id="l_costResult"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 三层加厚计算器 -->
    <div id="three-layer" class="content-container">
        <div class="three-layer-body">
            <!-- 第一列 -->
            <div class="three-layer-input-section">
                <h2>基础变量</h2>

                <!-- 损耗、幅宽、q8 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>损耗</label>
                        <input type="number" id="tl_e" placeholder="损耗" value="1.05" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>幅宽</label>
                        <input type="number" id="tl_W" placeholder="幅宽" value="150" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>扣点</label>
                        <input type="number" id="tl_q8" placeholder="扣点" value="0" required class="three-layer-input">
                    </div>
                </div>

                <!-- 贴袋长、贴袋宽 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>贴袋长</label>
                        <input type="number" id="tl_j4" placeholder="贴袋长" value="20" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>贴袋宽</label>
                        <input type="number" id="tl_j5" placeholder="贴袋宽" value="25" required class="three-layer-input">
                    </div>
                </div>

                <!-- 内袋长、内袋宽 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>内袋长</label>
                        <input type="number" id="tl_j6" placeholder="内袋长" value="21" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>内袋宽</label>
                        <input type="number" id="tl_j7" placeholder="内袋宽" value="34" required class="three-layer-input">
                    </div>
                </div>

                <!-- 内袋拉链排长、内袋拉链排宽 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>内袋拉链排长</label>
                        <input type="number" id="tl_j8" placeholder="内袋拉链排长" value="21" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>内袋拉链排宽</label>
                        <input type="number" id="tl_j9" placeholder="内袋拉链排宽" value="6" required class="three-layer-input">
                    </div>
                </div>

                <!-- 是否有贴袋、是否有内袋 -->
                <div class="three-layer-button-row">
                    <button id="tl_btnPocket" class="three-layer-button gray">没有贴袋</button>
                    <button id="tl_btnInnerBag" class="three-layer-button gray">没有内袋</button>
                </div>

                <!-- 是否有内袋拉链排、是否有内袋拉链 -->
                <div class="three-layer-button-row">
                    <button id="tl_btnInnerZip" class="three-layer-button gray">没有内袋拉链排</button>
                    <button id="tl_btnInnerZipButton" class="three-layer-button gray">没有内袋拉链</button>
                </div>
            </div>

            <!-- 第二列 -->
            <div class="three-layer-input-section-2">
                <h2>三层加厚</h2>

                <!-- 长、高、侧 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>长</label>
                        <input type="number" id="tl_q1" placeholder="长" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>高</label>
                        <input type="number" id="tl_q2" placeholder="高" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>侧</label>
                        <input type="number" id="tl_q3" placeholder="侧" required class="three-layer-input">
                    </div>
                </div>

                <!-- 订购数量、预留数量 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>订购数量</label>
                        <input type="number" id="tl_P" placeholder="订购数量" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>预留数量</label>
                        <input type="number" id="tl_n" placeholder="预留数量" required class="three-layer-input">
                    </div>
                </div>

                <!-- 外面料价、内面料价、数码印 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>外面料价</label>
                        <input type="number" id="tl_u1" class="three-layer-input u1" placeholder="外面料价" value="9.1" required>
                    </div>
                    <div class="three-layer-input-group">
                        <label>内面料价</label>
                        <input type="number" id="tl_u3" class="three-layer-input u3" placeholder="内面料价" value="5.1" required>
                    </div>
                    <div class="three-layer-input-group">
                        <label>数码印</label>
                        <input type="number" id="tl_x1" placeholder="数码印" value="2.5" required class="three-layer-input">
                    </div>
                </div>

                <!-- 左右出血、口头出血 -->
                <div class="three-layer-input-row">
                    <div class="three-layer-input-group">
                        <label>左右出血</label>
                        <input type="number" id="tl_r1" placeholder="左右出血" value="1.5" required class="three-layer-input">
                    </div>
                    <div class="three-layer-input-group">
                        <label>口头出血</label>
                        <input type="number" id="tl_r2" placeholder="口头出血" value="2" required class="three-layer-input">
                    </div>
                </div>

                <!-- 是否带外侧面、是否带口头牌、是否带内侧面 -->
                <div class="three-layer-button-row">
                    <button id="tl_btnOutSide" class="three-layer-button gray">不带外侧面</button>
                    <button id="tl_btnOralCard" class="three-layer-button gray">不带口头牌</button>
                    <button id="tl_btnInSide" class="three-layer-button gray">不带内侧面</button>
                </div>

                <!-- 计算和复位按钮 -->
                <div class="three-layer-button-row">
                    <button id="tl_calculateBtn" class="three-layer-button green">计算</button>
                    <button id="tl_resetBtn" class="three-layer-button red">复位</button>
                </div>
            </div>

            <!-- 第三列 -->
            <div class="three-layer-output-section">
                <h2>计算结果</h2>
                <!-- 修改后的三层加厚表格结构（与双层一致） -->
<table id="tl_resultTable" class="three-layer-table">
    <tbody>
        <tr>
            <td id="tl_result1"></td>
        </tr>
        <tr>
            <td id="tl_result2"></td>
        </tr>
        <!-- 更多单列行... -->
    </tbody>
</table>

                <!-- 布料、工费、印刷、手提、磁扣 -->
                <div class="input-group-row">
  <div class="input-col">
    <label>布料</label>
    <input type="number" id="tl_z1Input">
  </div>
  <div class="input-col">
    <label>工费</label>
    <input type="number" id="tl_z9Input" value="6.5">
  </div>
  <div class="input-col">
    <label>印刷</label>
    <input type="number" id="tl_z2Input">
  </div>
  <div class="input-col">
    <label>手提</label>
    <input type="number" id="tl_z3Input">
  </div>
  <div class="input-col">
    <label>磁扣</label>
    <input type="number" id="tl_z4Input" value="0.55">
  </div>
</div>

                <!-- 飘带、内袋、切工、打包、其他 -->
                <div class="input-group-row">
  <div class="input-col">
    <label>飘带</label>
    <input type="number" id="tl_z5Input" value="0">
  </div>
  <div class="input-col">
    <label>内袋</label>
    <input type="number" id="tl_z6Input" value="1.2">
  </div>
  <div class="input-col">
    <label>切工</label>
    <input type="number" id="tl_z7Input" value="0.3">
  </div>
  <div class="input-col">
    <label>打包</label>
    <input type="number" id="tl_z8Input">
  </div>
  <div class="input-col">
    <label>其他</label>
    <input type="number" id="tl_z10Input" value="0">
  </div>
</div>

                <!-- 成本输出 -->
                <div class="three-layer-cost-output">成本: <span id="tl_costValue">0.00</span></div>
            </div>
        </div>
    </div>

    <!-- 无底无侧/有底无侧计算器 -->
    <div id="other1" class="content-container">
        <div class="calculator-body">
            <div class="input-section">
                <h2>无底无侧/有底无侧</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label>长：</label>
                        <input type="number" id="o1_q1" placeholder="请输入长">
                    </div>
                    <div class="input-group">
                        <label>高：</label>
                        <input type="number" id="o1_q2" placeholder="请输入高">
                    </div>
                    <div class="input-group">
                        <label>侧：</label>
                        <input type="number" id="o1_q3" placeholder="请输入侧">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>订购数量：</label>
                        <input type="number" id="o1_p" placeholder="请输入订购数量">
                    </div>
                    <div class="input-group">
                        <label>预留数量：</label>
                        <input type="number" id="o1_n" placeholder="请输入预留数量">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>布料售价：</label>
                        <input type="number" id="o1_f1" value="6.1" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>数码印：</label>
                        <input type="number" id="o1_f2" value="1.3" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>面出血各：</label>
                        <input type="number" id="o1_r1" value="1.5" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>口头出血：</label>
                        <input type="number" id="o1_r2" value="5" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>幅宽：</label>
                        <input type="number" id="o1_W" value="150" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>损耗：</label>
                        <input type="number" id="o1_e" value="1.03" class="has-value">
                    </div>
                </div>

                <div class="button-group">
                    <button class="side" id="o1_sideButton" onclick="o1_toggleSide()">不带侧边</button>
                    <button class="calculate" onclick="o1_calculateCost()">成本核算</button>
                </div>
            </div>

            <div class="output-section">
                <h2>计算结果</h2>
                <table>
                    <tr>
                        <td id="o1_result1"></td>
                    </tr>
                    <tr>
                        <td id="o1_result2"></td>
                    </tr>
                </table>

                <div class="input-row">
                    <div class="input-group">
                        <label>布料：</label>
                        <input type="number" id="o1_g1Input" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>工费：</label>
                        <input type="number" id="o1_g9Input" value="0.6" class="has-value" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>印刷：</label>
                        <input type="number" id="o1_g2Input" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>手提：</label>
                        <input type="number" id="o1_g3Input" value="0.3" class="has-value" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>磁扣：</label>
                        <input type="number" id="o1_g4Input" value="0" class="has-value" oninput="o1_updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>飘带：</label>
                        <input type="number" id="o1_g5Input" value="0" class="has-value" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>内袋：</label>
                        <input type="number" id="o1_g6Input" value="0" class="has-value" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>切工：</label>
                        <input type="number" id="o1_g7Input" value="0" class="has-value" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>打包：</label>
                        <input type="number" id="o1_g8Input" oninput="o1_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>其他：</label>
                        <input type="number" id="o1_g10Input" value="0" class="has-value" oninput="o1_updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>成本：</label>
                        <span class="cost-result" id="o1_costResult"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 有底有侧计算器 -->
<!-- 有底有侧计算器HTML部分(修正ID冲突) -->
<div id="other2" class="content-container">
    <div class="calculator-body">
        <div class="input-section">
            <h2>有底有侧</h2>
            <div class="input-row">
                <div class="input-group">
                    <label>长：</label>
                    <input type="number" id="y_q1" placeholder="请输入长"> <!-- 添加y_前缀 -->
                </div>
                <div class="input-group">
                    <label>高：</label>
                    <input type="number" id="y_q2" placeholder="请输入高">
                </div>
                <div class="input-group">
                    <label>侧：</label>
                    <input type="number" id="y_q3" placeholder="请输入侧">
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label>订购数量：</label>
                    <input type="number" id="y_p" placeholder="请输入订购数量">
                </div>
                <div class="input-group">
                    <label>预留数量：</label>
                    <input type="number" id="y_n" placeholder="请输入预留数量">
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label>面料售价：</label>
                    <input type="number" id="y_f1" value="6.1" class="has-value">
                </div>
                <div class="input-group">
                    <label>数码印：</label>
                    <input type="number" id="y_f2" value="1.3" class="has-value">
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label>面出血各：</label>
                    <input type="number" id="y_r1" value="1.5" class="has-value">
                </div>
                <div class="input-group">
                    <label>侧出血共：</label>
                    <input type="number" id="y_r3" value="3" class="has-value">
                </div>
                <div class="input-group">
                    <label>口头出血：</label>
                    <input type="number" id="y_r2" value="5" class="has-value">
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label>幅宽：</label>
                    <input type="number" id="y_W" value="150" class="has-value">
                </div>
                <div class="input-group">
                    <label>损耗：</label>
                    <input type="number" id="y_e" value="1.03" class="has-value">
                </div>
                <div class="input-group">
                    <label>带刀扣点：</label>
                    <input type="number" id="y_q8" value="0" class="has-value">
                </div>
            </div>

            <div class="button-group">
                <button class="side" id="y_sideButton" onclick="y_toggleSide()">不带侧边</button> <!-- 修正函数绑定 -->
                <button class="calculate" onclick="y_calculateCost()">成本核算</button> <!-- 修正函数绑定 -->
            </div>
        </div>

        <div class="output-section">
            <h2>计算结果</h2>
            <table>
                <tr>
                    <td id="y_result1"></td> <!-- 添加y_前缀 -->
                </tr>
                <tr>
                    <td id="y_result2"></td>
                </tr>
                <tr>
                    <td id="y_result3"></td>
                </tr>
            </table>

            <div class="input-row">
                <div class="input-group">
                    <label>布料：</label>
                    <input type="number" id="y_g1Input" oninput="y_updateCost()"> <!-- 添加y_前缀 -->
                </div>
                <div class="input-group">
                    <label>工费：</label>
                    <input type="number" id="y_g9Input" value="1.1" class="has-value" oninput="y_updateCost()">
                </div>
                <div class="input-group">
                    <label>印刷：</label>
                    <input type="number" id="y_g2Input" oninput="y_updateCost()">
                </div>
                <div class="input-group">
                    <label>手提：</label>
                    <input type="number" id="y_g3Input" value="0.3" class="has-value" oninput="y_updateCost()">
                </div>
                <div class="input-group">
                    <label>磁扣：</label>
                    <input type="number" id="y_g4Input" value="0" class="has-value" oninput="y_updateCost()">
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label>飘带：</label>
                    <input type="number" id="y_g5Input" value="0" class="has-value" oninput="y_updateCost()">
                </div>
                <div class="input-group">
                    <label>内袋：</label>
                    <input type="number" id="y_g6Input" value="0" class="has-value" oninput="y_updateCost()">
                </div>
                <div class="input-group">
                    <label>切工：</label>
                    <input type="number" id="y_g7Input" value="0.1" class="has-value" oninput="y_updateCost()">
                </div>
                <div class="input-group">
                    <label>打包：</label>
                    <input type="number" id="y_g8Input" oninput="y_updateCost()">
                </div>
                <div class="input-group">
                    <label>其他：</label>
                    <input type="number" id="y_g10Input" value="0" class="has-value" oninput="y_updateCost()">
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label>成本：</label>
                    <span class="cost-result" id="y_costResult"></span> <!-- 添加y_前缀 -->
                </div>
            </div>
        </div>
    </div>
</div>

    <!-- 双层计算器 -->
    <div id="other3" class="content-container">
        <div class="calculator-body">
            <div class="input-section">
                <h2>双层</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label>长：</label>
                        <input type="number" id="d_q1" placeholder="请输入长">
                    </div>
                    <div class="input-group">
                        <label>高：</label>
                        <input type="number" id="d_q2" placeholder="请输入高">
                    </div>
                    <div class="input-group">
                        <label>侧：</label>
                        <input type="number" id="d_q3" placeholder="请输入侧">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>订购数量：</label>
                        <input type="number" id="d_p" placeholder="请输入订购数量">
                    </div>
                    <div class="input-group">
                        <label>预留数量：</label>
                        <input type="number" id="d_n" placeholder="请输入预留数量">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>外面料价：</label>
                        <input type="number" id="d_f1" value="8.3" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>内面料价：</label>
                        <input type="number" id="d_f3" value="6.1" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>数码印：</label>
                        <input type="number" id="d_f2" value="1.3" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>面出血各：</label>
                        <input type="number" id="d_r1" value="1.5" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>侧出血共：</label>
                        <input type="number" id="d_r3" value="3" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>口头出血：</label>
                        <input type="number" id="d_r2" value="5" class="has-value">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>幅宽：</label>
                        <input type="number" id="d_W" value="150" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>损耗：</label>
                        <input type="number" id="d_e" value="1.03" class="has-value">
                    </div>
                    <div class="input-group">
                        <label>带刀扣点：</label>
                        <input type="number" id="d_q8" value="0" class="has-value">
                    </div>
                </div>

                <div class="button-group">
                    <button class="side" id="d_sideButton" onclick="d_toggleSide()">不带侧边</button>
                    <button class="calculate" onclick="d_calculateCost()">成本核算</button>
                </div>
            </div>

            <div class="output-section">
                <h2>计算结果</h2>
                <table>
                    <tr>
                        <td id="d_result1"></td>
                    </tr>
                    <tr>
                        <td id="d_result2"></td>
                    </tr>
                    <tr>
                        <td id="d_result3"></td>
                    </tr>
                    <tr>
                        <td id="d_result4"></td>
                    </tr>
                    <tr>
                        <td id="d_result5"></td>
                    </tr>
                    <tr>
                        <td id="d_result6"></td>
                    </tr>
                </table>

                <div class="input-row">
                    <div class="input-group">
                        <label>布料：</label>
                        <input type="number" id="d_g1Input" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>工费：</label>
                        <input type="number" id="d_g9Input" value="6.5" class="has-value" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>印刷：</label>
                        <input type="number" id="d_g2Input" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>手提：</label>
                        <input type="number" id="d_g3Input" value="0.3" class="has-value" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>磁扣：</label>
                        <input type="number" id="d_g4Input" value="0.55" class="has-value" oninput="d_updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>飘带：</label>
                        <input type="number" id="d_g5Input" value="0" class="has-value" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>内袋：</label>
                        <input type="number" id="d_g6Input" value="1.3" class="has-value" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>切工：</label>
                        <input type="number" id="d_g7Input" value="0.1" class="has-value" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>打包：</label>
                        <input type="number" id="d_g8Input" oninput="d_updateCost()">
                    </div>
                    <div class="input-group">
                        <label>其他：</label>
                        <input type="number" id="d_g10Input" value="0" class="has-value" oninput="d_updateCost()">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label>成本：</label>
                        <span class="cost-result" id="d_costResult"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
// 导航栏交互逻辑
const tabWrapper = document.getElementById('tabWrapper');
const pullHandle = document.getElementById('pullHandle');
let startY = 0;
let isDragging = false;

// 点击下拉尾巴展开/收起
pullHandle.addEventListener('click', () => {
    tabWrapper.classList.toggle('expanded');
});

// 触摸事件处理
pullHandle.addEventListener('touchstart', (e) => {
    startY = e.touches[0].clientY;
    isDragging = true;
});

document.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    
    const currentY = e.touches[0].clientY;
    const diff = startY - currentY;
    
    // 向下滑动展开
    if (diff < -30 && !tabWrapper.classList.contains('expanded')) {
        tabWrapper.classList.add('expanded');
        isDragging = false;
    }
    // 向上滑动收起
    else if (diff > 30 && tabWrapper.classList.contains('expanded')) {
        tabWrapper.classList.remove('expanded');
        isDragging = false;
    }
});

document.addEventListener('touchend', () => {
    isDragging = false;
});

// 点击标签后自动收起
const tabs = document.querySelectorAll('.tab');
tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        // 移除所有活动状态
        tabs.forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.content-container').forEach(c => c.classList.remove('active'));
        
        // 添加当前活动状态
        tab.classList.add('active');
        const tabId = tab.getAttribute('data-tab');
        document.getElementById(tabId).classList.add('active');
        
        // 自动收起导航栏
        setTimeout(() => {
            tabWrapper.classList.remove('expanded');
        }, 300);
    });
});

        // 复合无纺布计算器功能
        let hasSide = false;

        function toggleSide() {
            const sideButton = document.getElementById('sideButton');
            if (hasSide) {
                sideButton.style.backgroundColor = 'gray';
                sideButton.textContent = '不带侧边';
                hasSide = false;
            } else {
                sideButton.style.backgroundColor = 'darkblue';
                sideButton.textContent = '有带侧边';
                hasSide = true;
            }
        }

        function calculateCost() {
            const q1 = parseFloat(document.getElementById('q1').value);
            const q2 = parseFloat(document.getElementById('q2').value);
            const q3 = parseFloat(document.getElementById('q3').value);
            const p = parseFloat(document.getElementById('p').value);
            const n = parseFloat(document.getElementById('n').value);
            let f1 = parseFloat(document.getElementById('f1').value);
            const f2 = parseFloat(document.getElementById('f2').value);
            const r1 = parseFloat(document.getElementById('r1').value);
            const r3 = parseFloat(document.getElementById('r3').value);
            const r2 = parseFloat(document.getElementById('r2').value);
            const W = parseFloat(document.getElementById('W').value);
            const e = parseFloat(document.getElementById('e').value);
            const q8 = parseFloat(document.getElementById('q8').value);

            let g9 = 3; // 默认 g9 = 3
            let a5 = 0, a6 = 0, a7 = 0, a8 = 0;
            let L3 = 0, L4 = 0;

            // 根据口头出血的值调整 f1 和 g9
            if (r2 === 1.5 || r2 === 2) {
                g9 = 4.5;
                a5 = 6;
                a6 = q1;
                a7 = 6;
                a8 = q3;

                // 计算 L3
                let maxS1 = 0, maxS2 = 0, c5Opt = 0, c6Opt = 0;
                for (let c5 = 1; c5 * a5 <= W; c5++) {
                    for (let c6 = 1; c6 * a6 <= W; c6++) {
                        const s1 = c5 * a5;
                        const s2 = c6 * a6;
                        if (s1 > maxS1 || (s1 === maxS1 && s2 > maxS2)) {
                            maxS1 = s1;
                            maxS2 = s2;
                            c5Opt = c5;
                            c6Opt = c6;
                        }
                    }
                }

                if (maxS1 >= maxS2) {
                    L3 = Math.ceil(2 * (p + n) * a6 * e / c5Opt / 100);
                } else {
                    L3 = Math.ceil(2 * (p + n) * a5 * e / c6Opt / 100);
                }

                // 计算 L4
                let maxS3 = 0, maxS4 = 0, c7Opt = 0, c8Opt = 0;
                for (let c7 = 1; c7 * a7 <= W; c7++) {
                    for (let c8 = 1; c8 * a8 <= W; c8++) {
                        const s3 = c7 * a7;
                        const s4 = c8 * a8;
                        if (s3 > maxS3 || (s3 === maxS3 && s4 > maxS4)) {
                            maxS3 = s3;
                            maxS4 = s4;
                            c7Opt = c7;
                            c8Opt = c8;
                        }
                    }
                }

                if (maxS3 >= maxS4) {
                    L4 = Math.ceil(2 * (p + n) * a8 * e / c7Opt / 100);
                } else {
                    L4 = Math.ceil(2 * (p + n) * a7 * e / c8Opt / 100);
                }
            }

            const a1 = q1 + 2 * r1;
            let a2 = 2 * q2 + q3 + 2 * r2;
            if (a2 % 1 === 0) a2 = Math.floor(a2);
            const a3 = parseFloat((q3 + r3).toFixed(1));
            const a4 = parseFloat((q2 + r2).toFixed(1));

            // 计算 L1
            let maxS1 = 0, maxS2 = 0, c1Opt = 0, c2Opt = 0;
            for (let c1 = 1; c1 * a1 <= W; c1++) {
                for (let c2 = 1; c2 * a2 <= W; c2++) {
                    const s1 = c1 * a1;
                    const s2 = c2 * a2;
                    if (s1 > maxS1 || (s1 === maxS1 && s2 > maxS2)) {
                        maxS1 = s1;
                        maxS2 = s2;
                        c1Opt = c1;
                        c2Opt = c2;
                    }
                }
            }

            let L1;
            if (maxS1 >= maxS2) {
                const temp = Math.ceil((p + n) / c1Opt);
                L1 = Math.ceil(temp * a2 * e / 100);
            } else {
                const temp = Math.ceil((p + n) / c2Opt);
                L1 = Math.ceil(temp * a1 * e / 100);
            }

            // S211: 计算带刀数值 d 和 b
            let b = 0;
            if (hasSide) {
                let d = 0;
                if (maxS1 >= maxS2) {
                    if (a1 * c1Opt > (W - a1 * c1Opt)) {
                        d = Math.floor(((W - q8) - a1 * c1Opt) / a3);
                    }
                } else {
                    if (a2 * c2Opt > (W - a2 * c2Opt)) {
                        d = Math.floor(((W - q8) - a2 * c2Opt) / a3);
                    }
                }
                b = Math.floor(L1 * 100 / a4) * d;
                if (b > 2 * (p + n)) b = 2 * (p + n);
            }

            // 计算 L2
            let maxS3 = 0, maxS4 = 0, c3Opt = 0, c4Opt = 0;
            for (let c3 = 1; c3 * a3 <= W; c3++) {
                for (let c4 = 1; c4 * a4 <= W; c4++) {
                    const s3 = c3 * a3;
                    const s4 = c4 * a4;
                    if (s3 > maxS3 || (s3 === maxS3 && s4 > maxS4)) {
                        maxS3 = s3;
                        maxS4 = s4;
                        c3Opt = c3;
                        c4Opt = c4;
                    }
                }
            }

            let L2;
            if (maxS3 >= maxS4) {
                const temp = (2 * (p + n) - b) / c3Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L2 = Math.ceil(finalTemp * a4 * e / 100);
            } else {
                const temp = (2 * (p + n) - b) / c4Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L2 = Math.ceil(finalTemp * a3 * e / 100);
            }

            // 更新计算结果
            const L = L1 + L2 + L3 + L4;
            const g1 = parseFloat(((L1 + L2 + L3 + L4) * f1 / p).toFixed(2));
            const g2 = parseFloat((a1 / 100 * a2 / 100 * f2 * (p + n) / p).toFixed(2));
            const g3 = parseFloat((0.55 * 0.58 * 2 * (p + n) / p + 0.39 * 0.25 * 2 * (p + n) / p + 2 * (p + n) * 0.15 / p + 2 / p).toFixed(2));
            const g4 = 0.55;
            const g5 = parseFloat(((q2 * 0.58 / 100) * (p + n) / p + 0.25 * (p + n) / p + 0.15).toFixed(2));
            const g7 = 0.3;
            let g8;
            if (p < 100) {
                g8 = parseFloat((10 / p).toFixed(2));
            } else {
                g8 = parseFloat((p / 70 * 10 / p).toFixed(2));
            }

            document.getElementById('g1Input').value = g1;
            document.getElementById('g2Input').value = g2;
            document.getElementById('g3Input').value = g3;
            document.getElementById('g4Input').value = g4;
            document.getElementById('g5Input').value = g5;
            document.getElementById('g7Input').value = g7;
            document.getElementById('g8Input').value = g8;
            document.getElementById('g9Input').value = g9;

            updateCost();

            // 更新输出表单
            document.getElementById('result1').textContent = `XX安涤棉复合XXg无纺布${L}米`;
            let result2Text = `面料：${a1}*${a2}，切${p + n}片，${L1}米`;
            if (b > 0) {
                result2Text += `，带${b}片侧面`;
            }
            document.getElementById('result2').textContent = result2Text;
            document.getElementById('result3').textContent = `外侧面：${a3}*${a4}，切${2 * (p + n) - b}片，${L2}米`;

            // 显示 L3 和 L4
            if (r2 === 1.5 || r2 === 2) {
                document.getElementById('result4').textContent = `口头牌：${a5}*${a6}，切${2 * (p + n)}片，${L3}米`;
                document.getElementById('result5').textContent = `侧牌：${a7}*${a8}，切${2 * (p + n)}片，${L4}米`;
            } else {
                document.getElementById('result4').textContent = '';
                document.getElementById('result5').textContent = '';
            }
        }

        function updateCost() {
            const g1 = parseFloat(document.getElementById('g1Input').value);
            const g9 = parseFloat(document.getElementById('g9Input').value);
            const g2 = parseFloat(document.getElementById('g2Input').value);
            const g3 = parseFloat(document.getElementById('g3Input').value);
            const g4 = parseFloat(document.getElementById('g4Input').value);
            const g5 = parseFloat(document.getElementById('g5Input').value);
            const g6 = parseFloat(document.getElementById('g6Input').value);
            const g7 = parseFloat(document.getElementById('g7Input').value);
            const g8 = parseFloat(document.getElementById('g8Input').value);
            const g10 = parseFloat(document.getElementById('g10Input').value);

            const k = (g1 + g9 + g2 + g3 + g4 + g5 + g6 + g7 + g8 + g10).toFixed(2);

            document.getElementById('costResult').textContent = k;
        }

        // 无底无侧/有底无侧计算器功能
        let o1_hasSide = false;

        function o1_toggleSide() {
            const sideButton = document.getElementById('o1_sideButton');
            if (o1_hasSide) {
                sideButton.style.backgroundColor = 'gray';
                sideButton.textContent = '不带侧边';
                o1_hasSide = false;
            } else {
                sideButton.style.backgroundColor = 'darkblue';
                sideButton.textContent = '有带侧边';
                o1_hasSide = true;
            }
        }

        function o1_calculateCost() {
            const q1 = parseFloat(document.getElementById('o1_q1').value);
            const q2 = parseFloat(document.getElementById('o1_q2').value);
            const q3 = parseFloat(document.getElementById('o1_q3').value);
            const p = parseFloat(document.getElementById('o1_p').value);
            const n = parseFloat(document.getElementById('o1_n').value);
            const f1 = parseFloat(document.getElementById('o1_f1').value);
            const f2 = parseFloat(document.getElementById('o1_f2').value);
            const r1 = parseFloat(document.getElementById('o1_r1').value);
            const r2 = parseFloat(document.getElementById('o1_r2').value);
            const W = parseFloat(document.getElementById('o1_W').value);
            const e = parseFloat(document.getElementById('o1_e').value);

            const a1 = q1 + 2 * r1;
            let a2 = 2 * q2 + q3 + 2 * r2;
            if (a2 % 1 === 0) a2 = Math.floor(a2);

            // 计算 L1
            let maxS1 = 0, maxS2 = 0, c1Opt = 0, c2Opt = 0;
            for (let c1 = 1; c1 * a1 <= W; c1++) {
                for (let c2 = 1; c2 * a2 <= W; c2++) {
                    const s1 = c1 * a1;
                    const s2 = c2 * a2;
                    if (s1 > maxS1 || (s1 === maxS1 && s2 > maxS2)) {
                        maxS1 = s1;
                        maxS2 = s2;
                        c1Opt = c1;
                        c2Opt = c2;
                    }
                }
            }

            let L1;
            if (maxS1 >= maxS2) {
                const temp = Math.ceil((p + n) / c1Opt);
                L1 = Math.ceil(temp * a2 * e / 100);
            } else {
                const temp = Math.ceil((p + n) / c2Opt);
                L1 = Math.ceil(temp * a1 * e / 100);
            }

            // 根据 q3 的值设置 g9
            let g9;
            if (q3 === 0) {
                g9 = 0.6;
            } else {
                g9 = 0.65;
            }

            // 更新计算结果
            const g1 = parseFloat((L1 * f1 / p).toFixed(2));
            const g2 = parseFloat((a1 / 100 * a2 / 100 * f2 * (p + n) / p).toFixed(2)); // 修改 g2 的计算方式
            const g3 = 0.3; // 默认 g3 = 0.3
            const g5 = 0; // 默认 g5 = 0
            const g7 = 0; // 默认 g7 = 0
            let g8;
            if (p < 250) {
                g8 = parseFloat((8 / p).toFixed(2));
            } else {
                g8 = parseFloat((p / 250 * 8 / p).toFixed(2));
            }

            document.getElementById('o1_g1Input').value = g1;
            document.getElementById('o1_g2Input').value = g2;
            document.getElementById('o1_g3Input').value = g3;
            document.getElementById('o1_g5Input').value = g5;
            document.getElementById('o1_g7Input').value = g7;
            document.getElementById('o1_g8Input').value = g8;
            document.getElementById('o1_g9Input').value = g9;

            o1_updateCost();

            // 更新输出表单
            const L = L1; // L = L1
            document.getElementById('o1_result1').textContent = `XX安涤棉${L}米`; // 修改第一行输出
            let result2Text = `面料：${a1}*${a2}，切${p + n}片，${L1}米`;
            document.getElementById('o1_result2').textContent = result2Text;
        }

        function o1_updateCost() {
            const g1 = parseFloat(document.getElementById('o1_g1Input').value);
            const g9 = parseFloat(document.getElementById('o1_g9Input').value);
            const g2 = parseFloat(document.getElementById('o1_g2Input').value);
            const g3 = parseFloat(document.getElementById('o1_g3Input').value);
            const g4 = parseFloat(document.getElementById('o1_g4Input').value);
            const g5 = parseFloat(document.getElementById('o1_g5Input').value);
            const g6 = parseFloat(document.getElementById('o1_g6Input').value);
            const g7 = parseFloat(document.getElementById('o1_g7Input').value);
            const g8 = parseFloat(document.getElementById('o1_g8Input').value);
            const g10 = parseFloat(document.getElementById('o1_g10Input').value); // 新增 g10

            const k = (g1 + g9 + g2 + g3 + g4 + g5 + g6 + g7 + g8 + g10).toFixed(2); // 加入 g10

            document.getElementById('o1_costResult').textContent = k;
        }

        // 淋膜袋计算器功能
        let l_hasSide = false;

        function l_toggleSide() {
            const sideButton = document.getElementById('l_sideButton');
            if (l_hasSide) {
                sideButton.style.backgroundColor = 'gray';
                sideButton.textContent = '不带侧边';
                l_hasSide = false;
            } else {
                sideButton.style.backgroundColor = 'darkblue';
                sideButton.textContent = '有带侧边';
                l_hasSide = true;
            }
        }

        function l_calculateCost() {
            const q1 = parseFloat(document.getElementById('l_q1').value);
            const q2 = parseFloat(document.getElementById('l_q2').value);
            const q3 = parseFloat(document.getElementById('l_q3').value);
            const p = parseFloat(document.getElementById('l_p').value);
            const n = parseFloat(document.getElementById('l_n').value);
            const f1 = parseFloat(document.getElementById('l_f1').value);
            const f2 = parseFloat(document.getElementById('l_f2').value);
            const r1 = parseFloat(document.getElementById('l_r1').value);
            const r3 = parseFloat(document.getElementById('l_r3').value);
            const r2 = parseFloat(document.getElementById('l_r2').value);
            const W = parseFloat(document.getElementById('l_W').value);
            const e = parseFloat(document.getElementById('l_e').value);
            const q8 = parseFloat(document.getElementById('l_q8').value);

            const a1 = q1 + 2 * r1;
            let a2 = parseFloat((q2 + r2).toFixed(1));
            if (a2 % 1 === 0) a2 = Math.floor(a2);
            const a3 = q3 + r3;
            let a4 = parseFloat((q1 + 2 * q2 + 2 * r2).toFixed(1));
            if (a4 % 1 === 0) a4 = Math.floor(a4);

            let maxS1 = 0, maxS2 = 0, c1Opt = 0, c2Opt = 0;
            for (let c1 = 1; c1 * a1 <= W; c1++) {
                for (let c2 = 1; c2 * a2 <= W; c2++) {
                    const s1 = c1 * a1;
                    const s2 = c2 * a2;
                    if (s1 > maxS1 || (s1 === maxS1 && s2 > maxS2)) {
                        maxS1 = s1;
                        maxS2 = s2;
                        c1Opt = c1;
                        c2Opt = c2;
                    }
                }
            }

            let L1;
            if (maxS1 >= maxS2) {
                const temp = Math.ceil((p + n) / c1Opt);
                L1 = Math.ceil(2 * temp * a2 * e / 100);
            } else {
                const temp = Math.ceil((p + n) / c2Opt);
                L1 = Math.ceil(2 * temp * a1 * e / 100);
            }

            let b = 0;
            if (l_hasSide) {
                let d = 0;
                if (maxS1 >= maxS2) {
                    if (a1 * c1Opt > (W - a1 * c1Opt)) {
                        d = Math.floor(((W - q8) - a1 * c1Opt) / a3);
                    }
                } else {
                    if (a2 * c2Opt > (W - a2 * c2Opt)) {
                        d = Math.floor(((W - q8) - a2 * c2Opt) / a3);
                    }
                }
                b = Math.floor(L1 * 100 / a4) * d;
                if (b > p + n) b = p + n;
            }

            let maxS3 = 0, maxS4 = 0, c3Opt = 0, c4Opt = 0;
            for (let c3 = 1; c3 * a3 <= W; c3++) {
                for (let c4 = 1; c4 * a4 <= W; c4++) {
                    const s3 = c3 * a3;
                    const s4 = c4 * a4;
                    if (s3 > maxS3 || (s3 === maxS3 && s4 > maxS4)) {
                        maxS3 = s3;
                        maxS4 = s4;
                        c3Opt = c3;
                        c4Opt = c4;
                    }
                }
            }

            let L2;
            if (maxS3 >= maxS4) {
                const temp = Math.ceil((p + n - b) / c3Opt);
                L2 = Math.ceil(temp * a4 * e / 100);
            } else {
                const temp = Math.ceil((p + n - b) / c4Opt);
                L2 = Math.ceil(temp * a3 * e / 100);
            }

            const g1 = parseFloat(((L1 + L2) * f1 / p).toFixed(2));
            const g2 = parseFloat((2 * a1 / 100 * a2 / 100 * f2 * (p + n) / p).toFixed(2));
            const g3 = parseFloat((0.55 * 0.58 * 2 * (p + n) / p + 0.39 * 0.25 * 2 * (p + n) / p + 2 * (p + n) * 0.15 / p + 2 / p).toFixed(2));
            const g5 = parseFloat((q2 * 0.58 / 100 * (p + n) / p + 0.25 * (p + n) / p + 0.15).toFixed(2));
            let g8;
            if (p < 100) {
                g8 = parseFloat((7 / p).toFixed(2));
            } else {
                g8 = parseFloat((p / 100 * 7 / p).toFixed(2));
            }

            document.getElementById('l_g1Input').value = g1;
            document.getElementById('l_g2Input').value = g2;
            document.getElementById('l_g3Input').value = g3;
            document.getElementById('l_g5Input').value = g5;
            document.getElementById('l_g8Input').value = g8;

            l_updateCost();

            document.getElementById('l_result1').textContent = `XX安涤棉XX淋膜${L1 + L2}米`;
            let result2Text = `面料：${a1}*${a2}，切${2 * (p + n)}片，${L1}米`;
            if (b > 0) {
                result2Text += `，带${b}片侧面`;
            }
            document.getElementById('l_result2').textContent = result2Text;
            document.getElementById('l_result3').textContent = `外侧面：${a3}*${a4}，切${p + n - b}片，${L2}米`;
        }

        function l_updateCost() {
            const g1 = parseFloat(document.getElementById('l_g1Input').value);
            const g9 = parseFloat(document.getElementById('l_g9Input').value);
            const g2 = parseFloat(document.getElementById('l_g2Input').value);
            const g3 = parseFloat(document.getElementById('l_g3Input').value);
            const g4 = parseFloat(document.getElementById('l_g4Input').value);
            const g5 = parseFloat(document.getElementById('l_g5Input').value);
            const g6 = parseFloat(document.getElementById('l_g6Input').value);
            const g7 = parseFloat(document.getElementById('l_g7Input').value);
            const g8 = parseFloat(document.getElementById('l_g8Input').value);
            const g10 = parseFloat(document.getElementById('l_g10Input').value);

            const k = (g1 + g9 + g2 + g3 + g4 + g5 + g6 + g7 + g8 + g10).toFixed(2);

            document.getElementById('l_costResult').textContent = k;
        }

        // 有底有侧计算器功能
        let y_hasSide = false;

        function y_toggleSide() {
            const sideButton = document.getElementById('y_sideButton');
            if (y_hasSide) {
                sideButton.style.backgroundColor = 'gray';
                sideButton.textContent = '不带侧边';
                y_hasSide = false;
            } else {
                sideButton.style.backgroundColor = 'darkblue';
                sideButton.textContent = '有带侧边';
                y_hasSide = true;
            }
        }

        function y_calculateCost() {
            const q1 = parseFloat(document.getElementById('y_q1').value);
            const q2 = parseFloat(document.getElementById('y_q2').value);
            const q3 = parseFloat(document.getElementById('y_q3').value);
            const p = parseFloat(document.getElementById('y_p').value);
            const n = parseFloat(document.getElementById('y_n').value);
            const f1 = parseFloat(document.getElementById('y_f1').value);
            const f2 = parseFloat(document.getElementById('y_f2').value);
            const r1 = parseFloat(document.getElementById('y_r1').value);
            const r3 = parseFloat(document.getElementById('y_r3').value);
            const r2 = parseFloat(document.getElementById('y_r2').value);
            const W = parseFloat(document.getElementById('y_W').value);
            const e = parseFloat(document.getElementById('y_e').value);
            const q8 = parseFloat(document.getElementById('y_q8').value);

            const a1 = q1 + 2 * r1;
            let a2 = 2 * q2 + q3 + 2 * r2;
            if (a2 % 1 === 0) a2 = Math.floor(a2);
            const a3 = parseFloat((q3 + r3).toFixed(1)); // a3 = q3 + r3，保留1位小数
            const a4 = parseFloat((q2 + r2).toFixed(1)); // a4 = q2 + r2，保留1位小数

            // 计算 L1
            let maxS1 = 0, maxS2 = 0, c1Opt = 0, c2Opt = 0;
            for (let c1 = 1; c1 * a1 <= W; c1++) {
                for (let c2 = 1; c2 * a2 <= W; c2++) {
                    const s1 = c1 * a1;
                    const s2 = c2 * a2;
                    if (s1 > maxS1 || (s1 === maxS1 && s2 > maxS2)) {
                        maxS1 = s1;
                        maxS2 = s2;
                        c1Opt = c1;
                        c2Opt = c2;
                    }
                }
            }

            let L1;
            if (maxS1 >= maxS2) {
                const temp = Math.ceil((p + n) / c1Opt);
                L1 = Math.ceil(temp * a2 * e / 100);
            } else {
                const temp = Math.ceil((p + n) / c2Opt);
                L1 = Math.ceil(temp * a1 * e / 100);
            }

            // S211: 计算带刀数值 d 和 b
            let b = 0;
            if (y_hasSide) {
                let d = 0;
                if (maxS1 >= maxS2) {
                    if (a1 * c1Opt > (W - a1 * c1Opt)) {
                        d = Math.floor(((W - q8) - a1 * c1Opt) / a3);
                    }
                } else {
                    if (a2 * c2Opt > (W - a2 * c2Opt)) {
                        d = Math.floor(((W - q8) - a2 * c2Opt) / a3);
                    }
                }
                b = Math.floor(L1 * 100 / a4) * d;
                if (b > 2 * (p + n)) b = 2 * (p + n); // 修正 b ≤ 2*(p+n)
            }

            // 计算 L2
            let maxS3 = 0, maxS4 = 0, c3Opt = 0, c4Opt = 0;
            for (let c3 = 1; c3 * a3 <= W; c3++) {
                for (let c4 = 1; c4 * a4 <= W; c4++) {
                    const s3 = c3 * a3;
                    const s4 = c4 * a4;
                    if (s3 > maxS3 || (s3 === maxS3 && s4 > maxS4)) {
                        maxS3 = s3;
                        maxS4 = s4;
                        c3Opt = c3;
                        c4Opt = c4;
                    }
                }
            }

            let L2;
            if (maxS3 >= maxS4) {
                const temp = (2 * (p + n) - b) / c3Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L2 = Math.ceil(finalTemp * a4 * e / 100);
            } else {
                const temp = (2 * (p + n) - b) / c4Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L2 = Math.ceil(finalTemp * a3 * e / 100);
            }

            // 更新计算结果
            const g1 = parseFloat(((L1 + L2) * f1 / p).toFixed(2));
            const g2 = parseFloat((a1 / 100 * a2 / 100 * f2 * (p + n) / p).toFixed(2)); // 修改 g2 的计算方式
            const g3 = 0.3; // 默认 g3 = 0.3
            const g5 = 0; // 默认 g5 = 0
            let g8;
            if (p < 250) {
                g8 = parseFloat((8 / p).toFixed(2));
            } else {
                g8 = parseFloat((p / 250 * 8 / p).toFixed(2));
            }

            document.getElementById('y_g1Input').value = g1;
            document.getElementById('y_g2Input').value = g2;
            document.getElementById('y_g3Input').value = g3;
            document.getElementById('y_g5Input').value = g5;
            document.getElementById('y_g8Input').value = g8;

            y_updateCost();

            // 更新输出表单
            const L = L1 + L2; // L = L1 + L2
            document.getElementById('y_result1').textContent = `XX安涤棉${L}米`; // 修改第一行输出
            let result2Text = `面料：${a1}*${a2}，切${p + n}片，${L1}米`;
            if (b > 0) {
                result2Text += `，带${b}片侧面`;
            }
            document.getElementById('y_result2').textContent = result2Text;
            document.getElementById('y_result3').textContent = `外侧面：${a3}*${a4}，切${2 * (p + n) - b}片，${L2}米`;
        }

        function y_updateCost() {
            const g1 = parseFloat(document.getElementById('y_g1Input').value);
            const g9 = parseFloat(document.getElementById('y_g9Input').value);
            const g2 = parseFloat(document.getElementById('y_g2Input').value);
            const g3 = parseFloat(document.getElementById('y_g3Input').value);
            const g4 = parseFloat(document.getElementById('y_g4Input').value);
            const g5 = parseFloat(document.getElementById('y_g5Input').value);
            const g6 = parseFloat(document.getElementById('y_g6Input').value);
            const g7 = parseFloat(document.getElementById('y_g7Input').value);
            const g8 = parseFloat(document.getElementById('y_g8Input').value);
            const g10 = parseFloat(document.getElementById('y_g10Input').value); // 新增 g10

            const k = (g1 + g9 + g2 + g3 + g4 + g5 + g6 + g7 + g8 + g10).toFixed(2); // 加入 g10

            document.getElementById('y_costResult').textContent = k;
        }

        // 双层计算器功能
        let d_hasSide = false;

        function d_toggleSide() {
            const sideButton = document.getElementById('d_sideButton');
            if (d_hasSide) {
                sideButton.style.backgroundColor = 'gray';
                sideButton.textContent = '不带侧边';
                d_hasSide = false;
            } else {
                sideButton.style.backgroundColor = 'darkblue';
                sideButton.textContent = '有带侧边';
                d_hasSide = true;
            }
        }

        function d_calculateCost() {
            const q1 = parseFloat(document.getElementById('d_q1').value);
            const q2 = parseFloat(document.getElementById('d_q2').value);
            const q3 = parseFloat(document.getElementById('d_q3').value);
            const p = parseFloat(document.getElementById('d_p').value);
            const n = parseFloat(document.getElementById('d_n').value);
            const f1 = parseFloat(document.getElementById('d_f1').value);
            const f2 = parseFloat(document.getElementById('d_f2').value);
            const f3 = parseFloat(document.getElementById('d_f3').value);
            const r1 = parseFloat(document.getElementById('d_r1').value);
            const r3 = parseFloat(document.getElementById('d_r3').value);
            const r2 = parseFloat(document.getElementById('d_r2').value);
            const W = parseFloat(document.getElementById('d_W').value);
            const e = parseFloat(document.getElementById('d_e').value);
            const q8 = parseFloat(document.getElementById('d_q8').value);

            const a1 = q1 + 2 * r1;
            let a2 = 2 * q2 + q3 + 2 * r2;
            if (a2 % 1 === 0) a2 = Math.floor(a2);
            const a3 = parseFloat((q3 + r3).toFixed(1));
            const a4 = parseFloat((q2 + r2).toFixed(1));
            const a5 = q1 + 2 * r1;
            const a6 = 2 * q2 + q3 - 4;
            const a7 = q3 + 2 * r1;
            let a8 = parseFloat((q2 - 2).toFixed(1));
            if (a8 % 1 === 0) a8 = Math.floor(a8);

            // 计算 L1
            let maxS1 = 0, maxS2 = 0, c1Opt = 0, c2Opt = 0;
            for (let c1 = 1; c1 * a1 <= W; c1++) {
                for (let c2 = 1; c2 * a2 <= W; c2++) {
                    const s1 = c1 * a1;
                    const s2 = c2 * a2;
                    if (s1 > maxS1 || (s1 === maxS1 && s2 > maxS2)) {
                        maxS1 = s1;
                        maxS2 = s2;
                        c1Opt = c1;
                        c2Opt = c2;
                    }
                }
            }

            let L1;
            if (maxS1 >= maxS2) {
                const temp = Math.ceil((p + n) / c1Opt);
                L1 = Math.ceil(temp * a2 * e / 100);
            } else {
                const temp = Math.ceil((p + n) / c2Opt);
                L1 = Math.ceil(temp * a1 * e / 100);
            }

            // S211: 计算带刀数值 d 和 b
            let b = 0;
            if (d_hasSide) {
                let d = 0;
                if (maxS1 >= maxS2) {
                    if (a1 * c1Opt > (W - a1 * c1Opt)) {
                        d = Math.floor(((W - q8) - a1 * c1Opt) / a3);
                    }
                } else {
                    if (a2 * c2Opt > (W - a2 * c2Opt)) {
                        d = Math.floor(((W - q8) - a2 * c2Opt) / a3);
                    }
                }
                b = Math.floor(L1 * 100 / a4) * d;
                if (b > 2 * (p + n)) b = 2 * (p + n);
            }

            // 计算 L2
            let maxS3 = 0, maxS4 = 0, c3Opt = 0, c4Opt = 0;
            for (let c3 = 1; c3 * a3 <= W; c3++) {
                for (let c4 = 1; c4 * a4 <= W; c4++) {
                    const s3 = c3 * a3;
                    const s4 = c4 * a4;
                    if (s3 > maxS3 || (s3 === maxS3 && s4 > maxS4)) {
                        maxS3 = s3;
                        maxS4 = s4;
                        c3Opt = c3;
                        c4Opt = c4;
                    }
                }
            }

            let L2;
            if (maxS3 >= maxS4) {
                const temp = (2 * (p + n) - b) / c3Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L2 = Math.ceil(finalTemp * a4 * e / 100);
            } else {
                const temp = (2 * (p + n) - b) / c4Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L2 = Math.ceil(finalTemp * a3 * e / 100);
            }

            // 计算 L3
            let maxS5 = 0, maxS6 = 0, c5Opt = 0, c6Opt = 0;
            for (let c5 = 1; c5 * a5 <= W; c5++) {
                for (let c6 = 1; c6 * a6 <= W; c6++) {
                    const s5 = c5 * a5;
                    const s6 = c6 * a6;
                    if (s5 > maxS5 || (s5 === maxS5 && s6 > maxS6)) {
                        maxS5 = s5;
                        maxS6 = s6;
                        c5Opt = c5;
                        c6Opt = c6;
                    }
                }
            }

            let L3;
            if (maxS5 >= maxS6) {
                const temp = (p + n) / c5Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L3 = Math.ceil(finalTemp * a6 * e / 100);
            } else {
                const temp = (p + n) / c6Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L3 = Math.ceil(finalTemp * a5 * e / 100);
            }

            // 计算 L4
            let maxS7 = 0, maxS8 = 0, c7Opt = 0, c8Opt = 0;
            for (let c7 = 1; c7 * a7 <= W; c7++) {
                for (let c8 = 1; c8 * a8 <= W; c8++) {
                    const s7 = c7 * a7;
                    const s8 = c8 * a8;
                    if (s7 > maxS7 || (s7 === maxS7 && s8 > maxS8)) {
                        maxS7 = s7;
                        maxS8 = s8;
                        c7Opt = c7;
                        c8Opt = c8;
                    }
                }
            }

            let L4;
            if (maxS7 >= maxS8) {
                const temp = 2 * (p + n) / c7Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L4 = Math.ceil(finalTemp * a8 * e / 100);
            } else {
                const temp = 2 * (p + n) / c8Opt;
                const tempInt = Math.floor(temp);
                const tempDecimal = temp - tempInt;
                const finalTemp = tempDecimal !== 0 ? tempInt + 1 : tempInt;
                L4 = Math.ceil(finalTemp * a7 * e / 100);
            }

            // 更新计算结果
            const g1 = parseFloat(((L1 + L2) * f1 / p + (L3 + L4) * f3 / p).toFixed(2));
            const g2 = parseFloat((a1 / 100 * a2 / 100 * f2 * (p + n) / p).toFixed(2));
            const g3 = parseFloat((0.55 * 0.58 * 2 * (p + n) / p + 0.39 * 0.25 * 2 * (p + n) / p + 2 * (p + n) * 0.15 / p + 2 / p).toFixed(2));
            const g5 = parseFloat((q2 * 0.58 / 100 * (p + n) / p + 0.25 * (p + n) / p + 0.15).toFixed(2));
            let g8;
            if (p < 100) {
                g8 = parseFloat((10 / p).toFixed(2));
            } else {
                g8 = parseFloat((p / 100 * 10 / p).toFixed(2));
            }

            document.getElementById('d_g1Input').value = g1;
            document.getElementById('d_g2Input').value = g2;
            document.getElementById('d_g3Input').value = g3;
            document.getElementById('d_g5Input').value = g5;
            document.getElementById('d_g8Input').value = g8;

            d_updateCost();

            // 更新输出表单
            document.getElementById('d_result1').textContent = `（外面）XX安涤棉${L1 + L2}米`;
            let result2Text = `外面料：${a1}*${a2}，切${p + n}片，${L1}米`;
            if (b > 0) {
                result2Text += `，带${b}片侧面`;
            }
            document.getElementById('d_result2').textContent = result2Text;
            document.getElementById('d_result3').textContent = `外侧面：${a3}*${a4}，切${2 * (p + n) - b}片，${L2}米`;
            document.getElementById('d_result4').textContent = `（里布）XX安涤棉${L3 + L4}米`;
            document.getElementById('d_result5').textContent = `内衬：${a5}*${a6}，切${p + n}片，${L3}米`;
            document.getElementById('d_result6').textContent = `内侧面：${a7}*${a8}，切${2 * (p + n)}片，${L4}米`;
        }

        function d_updateCost() {
            const g1 = parseFloat(document.getElementById('d_g1Input').value);
            const g9 = parseFloat(document.getElementById('d_g9Input').value);
            const g2 = parseFloat(document.getElementById('d_g2Input').value);
            const g3 = parseFloat(document.getElementById('d_g3Input').value);
            const g4 = parseFloat(document.getElementById('d_g4Input').value);
            const g5 = parseFloat(document.getElementById('d_g5Input').value);
            const g6 = parseFloat(document.getElementById('d_g6Input').value);
            const g7 = parseFloat(document.getElementById('d_g7Input').value);
            const g8 = parseFloat(document.getElementById('d_g8Input').value);
            const g10 = parseFloat(document.getElementById('d_g10Input').value);

            const k = (g1 + g9 + g2 + g3 + g4 + g5 + g6 + g7 + g8 + g10).toFixed(2);

            document.getElementById('d_costResult').textContent = k;
        }

        // 三层加厚计算器功能
        document.addEventListener('DOMContentLoaded', function() {
            const tl_calculateBtn = document.getElementById('tl_calculateBtn');
            const tl_resetBtn = document.getElementById('tl_resetBtn');
            const tl_resultTable = document.getElementById('tl_resultTable').getElementsByTagName('tbody')[0];

            // 获取所有按钮
            const tl_btnOutSide = document.getElementById('tl_btnOutSide');
            const tl_btnOralCard = document.getElementById('tl_btnOralCard');
            const tl_btnInSide = document.getElementById('tl_btnInSide');
            const tl_btnPocket = document.getElementById('tl_btnPocket');
            const tl_btnInnerBag = document.getElementById('tl_btnInnerBag');
            const tl_btnInnerZip = document.getElementById('tl_btnInnerZip');
            const tl_btnInnerZipButton = document.getElementById('tl_btnInnerZipButton');

            // 获取 z1 到 z10 的输入框
            const tl_z1Input = document.getElementById('tl_z1Input');
            const tl_z2Input = document.getElementById('tl_z2Input');
            const tl_z3Input = document.getElementById('tl_z3Input');
            const tl_z4Input = document.getElementById('tl_z4Input');
            const tl_z5Input = document.getElementById('tl_z5Input');
            const tl_z6Input = document.getElementById('tl_z6Input');
            const tl_z7Input = document.getElementById('tl_z7Input');
            const tl_z8Input = document.getElementById('tl_z8Input');
            const tl_z9Input = document.getElementById('tl_z9Input');
            const tl_z10Input = document.getElementById('tl_z10Input');

            // 获取成本输出元素
            const tl_costValue = document.getElementById('tl_costValue');

            // 复位按钮逻辑
            tl_resetBtn.addEventListener('click', () => {
                // 重置输入框的值
                document.getElementById('tl_q1').value = '';
                document.getElementById('tl_q2').value = '';
                document.getElementById('tl_q3').value = '';
                document.getElementById('tl_P').value = '';
                document.getElementById('tl_n').value = '';
                document.getElementById('tl_r1').value = 1.5;
                document.getElementById('tl_r2').value = 2;
                document.getElementById('tl_e').value = 1.05;
                document.getElementById('tl_W').value = 150;
                document.getElementById('tl_j4').value = 20;
                document.getElementById('tl_j5').value = 25;
                document.getElementById('tl_j6').value = 21;
                document.getElementById('tl_j7').value = 34;
                document.getElementById('tl_j8').value = 21;
                document.getElementById('tl_j9').value = 6;
                document.getElementById('tl_q8').value = 0;
                document.getElementById('tl_u1').value = 9.1;
                document.getElementById('tl_u3').value = 5.1;
                document.getElementById('tl_x1').value = 2.5;

                // 重置按钮状态
                tl_btnOutSide.classList.remove('blue');
                tl_btnOutSide.classList.add('gray');
                tl_btnOutSide.textContent = '不带外侧面';

                tl_btnOralCard.classList.remove('blue');
                tl_btnOralCard.classList.add('gray');
                tl_btnOralCard.textContent = '不带口头牌';

                tl_btnInSide.classList.remove('blue');
                tl_btnInSide.classList.add('gray');
                tl_btnInSide.textContent = '不带内侧面';

                tl_btnPocket.classList.remove('blue');
                tl_btnPocket.classList.add('gray');
                tl_btnPocket.textContent = '没有贴袋';

                tl_btnInnerBag.classList.remove('blue');
                tl_btnInnerBag.classList.add('gray');
                tl_btnInnerBag.textContent = '没有内袋';

                tl_btnInnerZip.classList.remove('blue');
                tl_btnInnerZip.classList.add('gray');
                tl_btnInnerZip.textContent = '没有内袋拉链排';

                tl_btnInnerZipButton.classList.remove('blue');
                tl_btnInnerZipButton.classList.add('gray');
                tl_btnInnerZipButton.textContent = '没有内袋拉链';

                // 清空结果表
                tl_resultTable.innerHTML = '';

                // 重置 z1 到 z10 的输入框
                tl_z1Input.value = 0;
                tl_z2Input.value = 0;
                tl_z3Input.value = 0;
                tl_z4Input.value = 0.55;
                tl_z5Input.value = 0;
                tl_z6Input.value = 1.2;
                tl_z7Input.value = 0.3;
                tl_z8Input.value = 0;
                tl_z9Input.value = 6.5;
                tl_z10Input.value = 0;

                // 重置成本
                tl_costValue.textContent = '0.00';
            });

            // 计算按钮逻辑
            tl_calculateBtn.addEventListener('click', () => {
                const q1 = parseFloat(document.getElementById('tl_q1').value);
                const q2 = parseFloat(document.getElementById('tl_q2').value);
                const q3 = parseFloat(document.getElementById('tl_q3').value);
                const P = parseInt(document.getElementById('tl_P').value);
                const n = parseInt(document.getElementById('tl_n').value);

                const r1 = parseFloat(document.getElementById('tl_r1').value);
                const r2 = parseFloat(document.getElementById('tl_r2').value);
                const W = parseFloat(document.getElementById('tl_W').value);
                const e = parseFloat(document.getElementById('tl_e').value);
                const j4 = parseFloat(document.getElementById('tl_j4').value);
                const j5 = parseFloat(document.getElementById('tl_j5').value);
                const j6 = parseFloat(document.getElementById('tl_j6').value);
                const j7 = parseFloat(document.getElementById('tl_j7').value);
                const j8 = parseFloat(document.getElementById('tl_j8').value);
                const j9 = parseFloat(document.getElementById('tl_j9').value);
                const q8 = parseFloat(document.getElementById('tl_q8').value);
                const u1 = parseFloat(document.getElementById('tl_u1').value);
                const u3 = parseFloat(document.getElementById('tl_u3').value);
                const x1 = parseFloat(document.getElementById('tl_x1').value);

                const hasOutSide = tl_btnOutSide.classList.contains('blue');
                const hasOralCard = tl_btnOralCard.classList.contains('blue');
                const hasInSide = tl_btnInSide.classList.contains('blue');
                const hasPocket = tl_btnPocket.classList.contains('blue');
                const hasInnerBag = tl_btnInnerBag.classList.contains('blue');
                const hasInnerZip = tl_btnInnerZip.classList.contains('blue');
                const hasInnerZipButton = tl_btnInnerZipButton.classList.contains('blue');

                // 计算基础参数
                const a1 = parseFloat((q1 + 2 * r1).toFixed(1));
                const a2 = parseFloat((q2 * 2 + q3 + 2 * r2).toFixed(1));
                const a3 = parseFloat((q3 + 2 * r1).toFixed(1));
                const a4 = parseFloat((q2 + r2).toFixed(1));
                const a5 = 6;
                const a6 = parseFloat(q1.toFixed(1));
                const a7 = 6;
                const a8 = parseFloat(q3.toFixed(1));
                const a9 = parseFloat((q1 + 2 * r1).toFixed(1));
                const j1 = parseFloat((q2 * 2 + q3 - 4).toFixed(1));
                const j2 = parseFloat((q3 + 2 * r1).toFixed(1));
                const j3 = parseFloat((q2 - 3).toFixed(1));

                // 计算 L1
                let maxS1 = 0;
                let maxS2 = 0;
                let bestC1 = 0;
                let bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / a1); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / a2); c2++) {
                        const s1 = a1 * c1;
                        const s2 = a2 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L1;
                if (maxS1 >= maxS2) {
                    L1 = Math.ceil((P + n) * a2 * e / bestC1 / 100);
                } else {
                    L1 = Math.ceil((P + n) * a1 * e / bestC2 / 100);
                }

                let b = 0;
                let g = 0;
                if (hasOutSide) {
                    let d;
                    if (maxS1 >= maxS2) {
                        if (maxS1 > (W - maxS1)) {
                            d = Math.floor(((W - q8) - maxS1) / a4);
                        }
                    } else {
                        if (maxS2 > (W - maxS2)) {
                            d = Math.floor(((W - q8) - maxS2) / a4);
                        }
                    }
                    if (d) {
                        b = Math.floor(L1 * 100 / a3) * d;
                        if (b > 2 * (P + n)) {
                            b = 2 * (P + n);
                        }
                    }
                    if (b === 0) {
                        if (maxS1 >= maxS2) {
                            if (maxS1 > (W - maxS1)) {
                                d = Math.floor(((W - q8) - maxS1) / a3);
                            }
                        } else {
                            if (maxS2 > (W - maxS2)) {
                                d = Math.floor(((W - q8) - maxS2) / a3);
                            }
                        }
                        if (d) {
                            b = Math.floor(L1 * 100 / a4) * d;
                            if (b > 2 * (P + n)) {
                                b = 2 * (P + n);
                            }
                        }
                    }
                } else if (!hasOutSide && hasOralCard) {
                    let d;
                    if (maxS1 >= maxS2) {
                        if (maxS1 > (W - maxS1)) {
                            d = Math.floor(((W - q8) - maxS1) / a5);
                        }
                    } else {
                        if (maxS2 > (W - maxS2)) {
                            d = Math.floor(((W - q8) - maxS2) / a5);
                        }
                    }
                    if (d) {
                        g = Math.floor(L1 * 100 / a6) * d;
                        if (g > 2 * (P + n)) {
                            g = 2 * (P + n);
                        }
                    }
                }

                // 计算 L2
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / a3); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / a4); c2++) {
                        const s1 = a3 * c1;
                        const s2 = a4 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L2;
                if (maxS1 >= maxS2) {
                    L2 = Math.ceil((2 * (P + n) - b) * a4 * e / bestC1 / 100);
                } else {
                    L2 = Math.ceil((2 * (P + n) - b) * a3 * e / bestC2 / 100);
                }

                let f = 0;
                if (hasOralCard) {
                    if (g === 2 * (P + n)) {
                        // 不做额外处理，后续在输出表单时不显示"带f片口头牌"
                    } else {
                        let d;
                        if (maxS1 >= maxS2) {
                            if (maxS1 > (W - maxS1)) {
                                d = Math.floor(((W - q8) - maxS1) / a6);
                            }
                        } else {
                            if (maxS2 > (W - maxS2)) {
                                d = Math.floor(((W - q8) - maxS2) / a6);
                            }
                        }
                        if (d) {
                            f = Math.floor(L2 * 100 / a5) * d;
                            if (f > 2 * (P + n)) {
                                f = 2 * (P + n);
                            }
                        }
                        if (f === 0) {
                            if (maxS1 >= maxS2) {
                                if (maxS1 > (W - maxS1)) {
                                    d = Math.floor(((W - q8) - maxS1) / a5);
                                }
                            } else {
                                if (maxS2 > (W - maxS2)) {
                                    d = Math.floor(((W - q8) - maxS2) / a5);
                                }
                            }
                            if (d) {
                                f = Math.floor(L2 * 100 / a6) * d;
                                if (f > 2 * (P + n)) {
                                    f = 2 * (P + n);
                                }
                            }
                        }
                    }
                }

                // 计算 L3
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / a5); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / a6); c2++) {
                        const s1 = a5 * c1;
                        const s2 = a6 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L3;
                if (maxS1 >= maxS2) {
                    L3 = Math.ceil((2 * (P + n) - f - g) * a6 * e / bestC1 / 100);
                } else {
                    L3 = Math.ceil((2 * (P + n) - f - g) * a5 * e / bestC2 / 100);
                }

                 // 计算 L4
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / a7); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / a8); c2++) {
                        const s1 = a7 * c1;
                        const s2 = a8 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L4;
                if (maxS1 >= maxS2) {
                    L4 = Math.ceil(2 * (P + n) * a8 * e / bestC1 / 100);
                } else {
                    L4 = Math.ceil(2 * (P + n) * a7 * e / bestC2 / 100);
                }

               // 计算 L5
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / a9); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / j1); c2++) {
                        const s1 = a9 * c1;
                        const s2 = j1 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L5;
                if (maxS1 >= maxS2) {
                    L5 = Math.ceil((P + n) * j1 * e / bestC1 / 100);
                } else {
                    L5 = Math.ceil((P + n) * a9 * e / bestC2 / 100);
                }

                let k = 0;
                if (hasInSide) {
                    // S251
                    let d;
                    if (maxS1 >= maxS2) {
                        if (a9 * bestC1 > (W - a9 * bestC1)) {
                            d = Math.floor(((W - q8) - a9 * bestC1) / j3);
                        }
                    } else {
                        if (j1 * bestC2 > (W - j1 * bestC2)) {
                            d = Math.floor(((W - q8) - j1 * bestC2) / j3);
                        }
                    }
                    if (d) {
                        k = Math.floor(L5 * 100 / j2) * d;
                        if (k > 2 * (P + n)) {
                            k = 2 * (P + n);
                        }
                    }
                    if (k === 0) {
                        // S252
                        if (maxS1 >= maxS2) {
                            if (a9 * bestC1 > (W - a9 * bestC1)) {
                                d = Math.floor(((W - q8) - a9 * bestC1) / j2);
                            }
                        } else {
                            if (j1 * bestC2 > (W - j1 * bestC2)) {
                                d = Math.floor(((W - q8) - j1 * bestC2) / j2);
                            }
                        }
                        if (d) {
                            k = Math.floor(L5 * 100 / j3) * d;
                            if (k > 2 * (P + n)) {
                                k = 2 * (P + n);
                            }
                        }
                    }
                }

                // 计算 L6
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / j2); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / j3); c2++) {
                        const s1 = j2 * c1;
                        const s2 = j3 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L6;
                if (maxS1 >= maxS2) {
                    L6 = Math.ceil((2*(P + n) -k) * j3 * e / bestC1 / 100);
                } else {
                    L6 = Math.ceil((2*(P + n) -k) * j2 * e / bestC2 / 100);
                }

                 // 计算 L7
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / j4); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / j5); c2++) {
                        const s1 =  j4 * c1;
                        const s2 =  j5 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L7 = 0;
                if (hasPocket) {
                    if (maxS1 >= maxS2) {
                        L7 = Math.ceil((P + n) *  j5 * e / bestC1 / 100);
                    } else {
                        L7 = Math.ceil( (P + n) *  j4 * e / bestC2 / 100);
                    }
                }

                // 计算 L8
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / j6); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / j7); c2++) {
                        const s1 =  j6 * c1;
                        const s2 =  j7 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L8 = 0;
                if (hasInnerBag) {
                    if (maxS1 >= maxS2) {
                        L8 = Math.ceil((P + n) *  j7 * e / bestC1 / 100);
                    } else {
                        L8 = Math.ceil( (P + n) *  j6 * e / bestC2 / 100);
                    }
                }
                
                // 计算 L9
                maxS1 = 0;
                maxS2 = 0;
                bestC1 = 0;
                bestC2 = 0;
                for (let c1 = 1; c1 <= Math.floor(W / j8); c1++) {
                    for (let c2 = 1; c2 <= Math.floor(W / j9); c2++) {
                        const s1 =  j8 * c1;
                        const s2 =  j9 * c2;
                        if (s1 <= W && s2 <= W) {
                            if (s1 + s2 > maxS1 + maxS2) {
                                maxS1 = s1;
                                maxS2 = s2;
                                bestC1 = c1;
                                bestC2 = c2;
                            }
                        }
                    }
                }
                let L9 = 0;
                if (hasInnerZip) {
                    if (maxS1 >= maxS2) {
                        L9 = Math.ceil((P + n) *  j9 * e / bestC1 / 100);
                    } else {
                        L9 = Math.ceil( (P + n) *  j8 * e / bestC2 / 100);
                    }
                }

                // 计算 z1 到 z10
                const z1 = ((L1 + L2 + L3 + L4) * u1 / P + (L5 + L6 + L7 + L8 + L9) * u3 / P).toFixed(2);
                const z2 = (a1 / 100 * a2 / 100 * x1 * (P + n) / P).toFixed(2);
                const z9 = 6.5;
                const z3 = (0.55 * 0.58 * 2 * (P + n) / P + 0.39 * 0.25 * 2 * (P + n) / P + 2 * (P + n) * 0.15 / P + 2 / P).toFixed(2);
                const z5 = ((q2 * 0.58 / 100) * (P + n) / P + 0.25 * (P + n) / P + 0.15).toFixed(2);
                const z4 = 0.55;
                const z6 = 1.2;
                const z7 = 0.3;
                const z8 = P >= 70 ? (P / 70 * 10 / P).toFixed(2) : (10 / P).toFixed(2);
                const z10 = 0;

                // 设置 z1 到 z10 的输入框值
                tl_z1Input.value = z1;
                tl_z2Input.value = z2;
                tl_z3Input.value = z3;
                tl_z4Input.value = z4;
                tl_z5Input.value = z5;
                tl_z6Input.value = z6;
                tl_z7Input.value = z7;
                tl_z8Input.value = z8;
                tl_z9Input.value = z9;
                tl_z10Input.value = z10;

                // 计算成本
                const calculateCost = () => {
                    const z1Value = parseFloat(tl_z1Input.value);
                    const z2Value = parseFloat(tl_z2Input.value);
                    const z3Value = parseFloat(tl_z3Input.value);
                    const z4Value = parseFloat(tl_z4Input.value);
                    const z5Value = parseFloat(tl_z5Input.value);
                    const z6Value = parseFloat(tl_z6Input.value);
                    const z7Value = parseFloat(tl_z7Input.value);
                    const z8Value = parseFloat(tl_z8Input.value);
                    const z9Value = parseFloat(tl_z9Input.value);
                    const z10Value = parseFloat(tl_z10Input.value);

                    const cost = z1Value + z2Value + z3Value + z4Value + z5Value + z6Value + z7Value + z8Value + z9Value + z10Value;
                    tl_costValue.textContent = cost.toFixed(2);
                };

                // 初始化成本计算
                calculateCost();

                // 添加事件监听器，实时更新成本
                tl_z1Input.addEventListener('input', calculateCost);
                tl_z2Input.addEventListener('input', calculateCost);
                tl_z3Input.addEventListener('input', calculateCost);
                tl_z4Input.addEventListener('input', calculateCost);
                tl_z5Input.addEventListener('input', calculateCost);
                tl_z6Input.addEventListener('input', calculateCost);
                tl_z7Input.addEventListener('input', calculateCost);
                tl_z8Input.addEventListener('input', calculateCost);
                tl_z9Input.addEventListener('input', calculateCost);
                tl_z10Input.addEventListener('input', calculateCost);

                // 构建输出表单
                tl_resultTable.innerHTML = '';
                const results = [
  `外面料总: ${L1 + L2 + L3 + L4}米`,
  `面料: ${a1}*${a2}，切 ${P + n} 片，${L1} 米${b > 0 ? `，带 ${b} 片侧边` : ''}`,
  `外侧面: ${a3}*${a4}，切 ${2 * (P + n) - b} 片，${L2} 米`,
  `口头牌: ${a5}*${a6}，切 ${2 * (P + n) - g - f} 片，${L3} 米`,
  `侧牌: ${a7}*${a8}，切 ${2 * (P + n)} 片，${L4} 米`,
  `内面料总: ${L5 + L6 + L7 + L8 + L9} 米`,
  `内衬: ${a9}*${j1}，切 ${P + n} 片，${L5} 米${k > 0 ? `，带 ${k} 片内侧面` : ''}`,
  `内侧面: ${j2}*${j3}，切 ${2 * (P + n) - k} 片，${L6} 米`
];

// 动态生成与双层一致的单列行
results.forEach(resultText => {
  const row = tl_resultTable.insertRow();
  const cell = row.insertCell();
  cell.textContent = resultText;
});

// 条件性添加可选行
if (hasPocket) {
  addConditionalRow(`贴袋: ${j4}*${j5}，切 ${P + n} 片，${L7} 米`);
}
if (hasInnerBag) {
  addConditionalRow(`内袋: ${j6}*${j7}，切 ${P + n} 片，${L8} 米`);
}
if (hasInnerZip) {
  addConditionalRow(`内袋拉链牌: ${j8}*${j9}，切 ${P + n} 片，${L9} 米`);
}
if (hasInnerZipButton) {
  addConditionalRow(`内袋拉链: ${j8}长，${P + n} 条`);
}

// 封装条件行添加函数
function addConditionalRow(text) {
  const row = tl_resultTable.insertRow();
  const cell = row.insertCell();
  cell.textContent = text;
}
            });

            // 按钮切换逻辑
            const tl_buttons = document.querySelectorAll('button[id^="tl_btn"]');
            tl_buttons.forEach(button => {
                button.addEventListener('click', () => {
                    if (button.classList.contains('blue')) {
                        button.classList.remove('blue');
                        button.classList.add('gray');
                        button.textContent = button.textContent.replace('带', '不带').replace('有', '没有');
                    } else {
                        button.classList.remove('gray');
                        button.classList.add('blue');
                        button.textContent = button.textContent.replace('不带', '带').replace('没有', '有');
                    }
                });
            });

            // 输入框为空时显示橙色底色
            const tl_inputs = document.querySelectorAll('.three-layer-input[type="number"]');
            tl_inputs.forEach(input => {
                input.addEventListener('input', () => {
                    if (input.value === '') {
                        input.style.backgroundColor = 'orange';
                    } else {
                        input.style.backgroundColor = '#f9f9f9';
                    }
                });
            });
        });

        // 监听输入框的变化，更新背景颜色
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', function () {
                if (this.value !== '') {
                    this.classList.add('has-value');
                } else {
                    this.classList.remove('has-value');
                }
            });
        });
    </script>
</body>
</html>